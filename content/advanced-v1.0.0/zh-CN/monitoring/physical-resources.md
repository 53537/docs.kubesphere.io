---
title: "物理资源监控"
---

现代 IT 企业每天巨大的流量和海量业务运行背后，依靠的是其成千上万台服务器日夜不停的运转，以支撑海量业务的运转。宕机或服务器状态异常，都有可能给企业造成非常严重且不可挽回的损失。对于运维人员而言，对成千上万台主机进行系统指标的人工检查和不间断监控几乎是不可能的。因此，监控平台所运行的集群物理资源运行状态是极其重要的。

成熟稳健的系统往往需要对集群运行时的各个指标进行收集，如系统的 CPU 平均负载、CPU 利用率、内存利用率、磁盘 I/O、网络速率、IOPS、inode 使用率等，对这些系统信息实时监控，一旦发现异常情况，能够第一时间通知到研发或运维人员处理，在用户还没有察觉之前完成故障和异常的修复处理，能够将企业的损失大大降低，防患于未然。

KubeSphere 监控中心在 **物理资源监控** 提供了以上提到的物理资源层级的 CPU、内存、网络和磁盘等相关指标的监控，并支持回看历史监控和节点用量排行。

## 查看物理资源状态

物理资源监控，即监控集群所有节点的物理资源运行状态，如节点的所有 CPU、内存、磁盘、容器组的使用情况和组件的运行状态。物理资源状态在控制台的 **平台管理 → 监控中心** 页面可供查看。

### 前提条件

已有集群管理员 (Cluster-admin) 账号，或当前用户的角色在权限列表中勾选了 **查看监控管理**。

### 查看集群状态

在左侧选择 **物理资源监控**，可以看到集群状态的监控页面，包括 **集群节点状态、组件状态、集群资源使用情况** 等三个部分。

![集群状态监控](/cluster-status-monitoring.png)

#### 集群节点状态

集群节点状态显示当前所有节点在线状态，支持下钻到主机管理页面查看所有主机实时的资源使用情况，点击 **节点在线状态** 进入主机管理列表。

例如以下列表的 `192.168.0.55` 节点，显然它的内存空间不足，点击进去查看该主机的详情页面。

![集群节点状态](/nodes-list.png)

从节点详情页，当前主机的 CPU、内存、本地存储、容器组使用情况从监控反馈的饼图中即可一目了然。明细发现内存使用率已高达 93 %，这种情况可能需要对该主机采取措施，比如对其进行扩容或通过添加污点的方式禁止调度新的工作负载到当前主机。

![节点监控详情](/node-monitoring-details.png)

在主机详情页点击 **监控** tab，可以查看该主机的 CPU 使用率、CPU 平均负载、内存使用率、磁盘使用率、inode 使用率、IOPS、磁盘吞吐、网卡速率。对于主机而言，除了 CPU、内存、磁盘等使用率、磁盘吞吐这类常用监控指标，inode 使用率和 CPU 平均负载的监控信息对于主机资源管理也是非常有帮助的。

![监控 tab](/node-details-monitoring-page.png)

#### 查看组件状态

服务组件提供 KubeSphere、Kubernetes 和 OpenPitrix 集群内各项服务组件的健康状态监控，若某些核心的服务组件出现异常，可能会导致系统不可用。查看当前集群服务组件的健康状态和运行时间，能够帮助用户监测集群的状况和及时定位问题。

点击 **组件状态** 即可跳转到服务组件的详情页面，如下可以看到 OpenPitrix 有一个组件状态异常，其 Tab 显示黄色的异常状态。

![查看组件状态](/service-components-list.png)

#### 查看集群资源使用情况

集群资源的监控指标包括当前集群所有节点的 **CPU、内存、磁盘等利用率和容器组使用数量变化**，点击左边的饼状图即可切换指标。监控的时间间隔为 40 分钟，四项监控指标的纵坐标都会随时间动态变化。该监控图可以一览整个集群的资源消化状况，对于集群管理员而言，是需要密切关注这部分的监控指标的。当资源接近饱和状态时，可以通过增加节点或扩容磁盘、内存等操作，调节集群的负载能力。

![集群资源使用情况](/cluster-resources-monitoring.png)


